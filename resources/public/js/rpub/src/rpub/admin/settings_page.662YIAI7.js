import*as l from"cherry-cljs/cljs.core.js";import*as b from"rpub.admin.impl";import{use_dag as M}from"rpub.lib.dag.react";import*as v from"rpub.lib.html";import*as N from"rpub.lib.http";var G=function(t){const _=t,s=l.__destructure_map.call(null,_),f=s,k=l.get.call(null,s,l.keyword("settings")),h=M.call(null,l.vector(l.keyword("rpub.admin.settings-page/field-values"),l.keyword("rpub.admin.settings-page/submitting"))),A=l.nth.call(null,h,0,null),x=l.__destructure_map.call(null,A),p=l.get.call(null,x,l.keyword("rpub.admin.settings-page/field-values")),D=l.get.call(null,x,l.keyword("rpub.admin.settings-page/submitting")),m=l.nth.call(null,h,1,null),S=b.index_by.call(null,l.keyword("key"),k),I=l.array_map(l.keyword("format"),l.keyword("transit")),q=function(i,u){const c=u.target.value;return m.call(null,l.keyword("rpub.admin.settings-page/change-input"),l.vector(i,c))},K=function(i){i.preventDefault(),m.call(null,l.keyword("rpub.admin.settings-page/submit-start"));const u=function(a,r){return l.truth_.call(null,r)?m.call(null,l.keyword("rpub.admin.settings-page/submit-error")):window.location.reload()},c=l.vals.call(null,l.update_vals.call(null,l.merge_with.call(null,function(a,r){return l.assoc.call(null,a,l.keyword("value"),r)},S,p),function(a){return l.select_keys.call(null,a,l.vector(l.keyword("key"),l.keyword("value")))})),w=l.merge.call(null,I,l.array_map(l.keyword("body"),l.array_map(l.keyword("settings"),c),l.keyword("on-complete"),u));return N.post.call(null,"/admin/api/update-settings",w)};return l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"p-4"),l.vector(b.box,l.array_map(l.keyword("title"),"Settings",l.keyword("content"),l.vector(l.keyword("section"),l.array_map(l.keyword("class"),"bg-white"),l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"max-w-2xl"),l.vector(l.keyword("form"),l.array_map(l.keyword("on-submit"),K),l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"grid gap-4 sm:grid-cols-2 sm:gap-6"),function u(c){return new l.LazySeq(null,function(){let w=c;for(;;){const a=l.seq.call(null,w);if(l.truth_.call(null,a)){const r=a;if(l.truth_.call(null,l.chunked_seq_QMARK_.call(null,r))){const e=l.chunk_first.call(null,r),n=l.count.call(null,e),g=l.chunk_buffer.call(null,n);return(()=>{let d=0;for(;;){if(d<n){const o=l._nth.call(null,e,d);l.chunk_append.call(null,g,l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.keyword("key").call(null,o),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm font-semibold text-gray-900",l.keyword("for"),"name"),l.keyword("label").call(null,o)),l.prn.call(null,o),l.vector(v.input2,l.array_map(l.keyword("type"),l.keyword("text"),l.keyword("name"),l.keyword("key").call(null,o),l.keyword("value"),(()=>{const y=l.get.call(null,p,l.keyword("key").call(null,o));return l.truth_.call(null,y)?y:l.keyword("value").call(null,o)})(),l.keyword("on-change"),function(y){return q.call(null,l.keyword("key").call(null,o),y)})))),d=l.unchecked_inc.call(null,d);continue}else return!0;break}})()?l.chunk_cons.call(null,l.chunk.call(null,g),u.call(null,l.chunk_rest.call(null,r))):l.chunk_cons.call(null,l.chunk.call(null,g),null)}else{const e=l.first.call(null,r);return l.cons.call(null,l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.keyword("key").call(null,e),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm font-semibold text-gray-900",l.keyword("for"),"name"),l.keyword("label").call(null,e)),l.prn.call(null,e),l.vector(v.input2,l.array_map(l.keyword("type"),l.keyword("text"),l.keyword("name"),l.keyword("key").call(null,e),l.keyword("value"),(()=>{const n=l.get.call(null,p,l.keyword("key").call(null,e));return l.truth_.call(null,n)?n:l.keyword("value").call(null,e)})(),l.keyword("on-change"),function(n){return q.call(null,l.keyword("key").call(null,e),n)}))),u.call(null,l.rest.call(null,r)))}}break}},null,null)}.call(null,l.sort_by.call(null,l.keyword("label"),l.vals.call(null,S))),l.vector(v.submit_button,l.array_map(l.keyword("ready-label"),"Save",l.keyword("submit-label"),"Saving...",l.keyword("submitting"),D)))))))))},z=function(t,_){const s=_,f=l.nth.call(null,s,0,null),k=l.nth.call(null,s,1,null);return l.assoc_in.call(null,t,l.vector(l.keyword("inputs"),f,l.keyword("value")),k)},E=function(t){return l.assoc.call(null,t,l.keyword("rpub.admin.settings-page/submitting"),!0)},L=function(t){return l.assoc.call(null,t,l.keyword("rpub.admin.settings-page/submitting"),!1)},Q=l.array_map(l.keyword("nodes"),l.array_map(l.keyword("rpub.admin.settings-page/change-input"),l.array_map(l.keyword("push"),z),l.keyword("rpub.admin.settings-page/field-values"),l.array_map(l.keyword("calc"),b.field_values),l.keyword("rpub.admin.settings-page/submit-error"),l.array_map(l.keyword("push"),L),l.keyword("rpub.admin.settings-page/submit-start"),l.array_map(l.keyword("push"),E),l.keyword("rpub.admin.settings-page/submitting"),l.array_map(l.keyword("calc"),l.keyword("rpub.admin.settings-page/submitting"))),l.keyword("edges"),l.vector(l.vector(l.keyword("rpub.admin.settings-page/change-input"),l.keyword("rpub.admin.settings-page/field-values")),l.vector(l.keyword("rpub.admin.settings-page/submit-error"),l.keyword("rpub.admin.settings-page/submitting")),l.vector(l.keyword("rpub.admin.settings-page/submit-start"),l.keyword("rpub.admin.settings-page/submitting")))),O=l.array_map(l.keyword("page-id"),l.keyword("settings-page"),l.keyword("component"),G,l.keyword("dag-config"),Q);export{z as change_input,O as config,Q as dag_config,G as page,L as submit_error,E as submit_start};
