import*as l from"cherry-cljs/cljs.core.js";import"rpub.lib.dag";import{use_sub as w,use_dispatch as x}from"rpub.lib.dag.react";var y=function(r,e,n){const t=l.get.call(null,l.keyword("schema").call(null,r),e);if(l.truth_.call(null,t)){const a=t,o=l.__destructure_map.call(null,a),u=l.get.call(null,o,l.keyword("valid")),s=l.get.call(null,o,l.keyword("message"));return l.truth_.call(null,u.call(null,n))?l.array_map(l.keyword("valid"),!0):l.array_map(l.keyword("valid"),!1,l.keyword("message"),s)}},p=function(r,e){const n=e,t=l.nth.call(null,n,0,null),a=l.nth.call(null,n,1,null),o=l.nth.call(null,n,2,null);return l.update_in.call(null,l.update_in.call(null,l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,t),a,l.keyword("value")),o),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,t),a),l.dissoc,l.keyword("valid"),l.keyword("message")),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,t),a),l.merge,y.call(null,t,a,o))},f=function(r,e){return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,e)),!1)},v=function(r,e){return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,e)),!0)},b=function(r,e){const n=l.reduce_kv.call(null,function(t,a,o){return l.assoc.call(null,t,a,l.merge.call(null,l.array_map(l.keyword("value"),o),y.call(null,e,a,o)))},l.array_map(),l.keyword("initial-values").call(null,e));return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,e)),n)},_=(()=>{const r=function(e){switch(l.alength.call(null,arguments)){case 1:return r.cljs$core$IFn$_invoke$arity$1(arguments[0]);case 2:return r.cljs$core$IFn$_invoke$arity$2(arguments[0],arguments[1]);default:throw new Error(l.str.call(null,"Invalid arity: ",l.alength.call(null,arguments)))}};return r.cljs$core$IFn$_invoke$arity$1=function(e){return l.keyword("rpub.lib.forms/inputs").call(null,e)},r.cljs$core$IFn$_invoke$arity$2=function(e,n){const t=l.truth_.call(null,l.vector_QMARK_.call(null,n))?n:l.vector(n),a=l.seq.call(null,t),o=l.first.call(null,a),u=l.next.call(null,a),s=o,i=u,d=l.get.call(null,_.call(null,e),l.keyword("id").call(null,s));return l.truth_.call(null,l.seq.call(null,i))?l.get_in.call(null,d,i):d},r.cljs$lang$maxFixedArity=2,r})(),m=(()=>{const r=function(e){switch(l.alength.call(null,arguments)){case 1:return r.cljs$core$IFn$_invoke$arity$1(arguments[0]);case 2:return r.cljs$core$IFn$_invoke$arity$2(arguments[0],arguments[1]);default:throw new Error(l.str.call(null,"Invalid arity: ",l.alength.call(null,arguments)))}};return r.cljs$core$IFn$_invoke$arity$1=function(e){return l.keyword("rpub.lib.forms/field-values").call(null,l.keyword("rpub.lib.dag/values").call(null,e))},r.cljs$core$IFn$_invoke$arity$2=function(e,n){return l.every_QMARK_.call(null,l.keyword("valid"),l.vals.call(null,l.get.call(null,m.call(null,e),l.keyword("id").call(null,n))))},r.cljs$lang$maxFixedArity=2,r})(),k=(()=>{const r=function(e){switch(l.alength.call(null,arguments)){case 1:return r.cljs$core$IFn$_invoke$arity$1(arguments[0]);case 2:return r.cljs$core$IFn$_invoke$arity$2(arguments[0],arguments[1]);default:throw new Error(l.str.call(null,"Invalid arity: ",l.alength.call(null,arguments)))}};return r.cljs$core$IFn$_invoke$arity$1=function(e){return l.keyword("rpub.lib.forms/submitting").call(null,e)},r.cljs$core$IFn$_invoke$arity$2=function(e,n){return l.get.call(null,k.call(null,e),l.keyword("id").call(null,n))},r.cljs$lang$maxFixedArity=2,r})(),G=l.array_map(l.keyword("nodes"),l.array_map(l.keyword("rpub.lib.forms/init"),l.array_map(l.keyword("push"),b),l.keyword("rpub.lib.forms/change-input"),l.array_map(l.keyword("push"),p),l.keyword("rpub.lib.forms/field-values"),l.array_map(l.keyword("calc"),_),l.keyword("rpub.lib.forms/submit-error"),l.array_map(l.keyword("push"),f),l.keyword("rpub.lib.forms/submit-start"),l.array_map(l.keyword("push"),v),l.keyword("rpub.lib.forms/submitting"),l.array_map(l.keyword("calc"),k),l.keyword("rpub.lib.forms/ready-to-submit"),l.array_map(l.keyword("calc"),m)),l.keyword("edges"),l.vector(l.vector(l.keyword("rpub.lib.forms/init"),l.keyword("rpub.lib.forms/field-values")),l.vector(l.keyword("rpub.lib.forms/change-input"),l.keyword("rpub.lib.forms/field-values")),l.vector(l.keyword("rpub.lib.forms/field-values"),l.keyword("rpub.lib.forms/ready-to-submit")),l.vector(l.keyword("rpub.lib.forms/submit-error"),l.keyword("rpub.lib.forms/submitting")),l.vector(l.keyword("rpub.lib.forms/submit-start"),l.keyword("rpub.lib.forms/submitting")))),g=function(r){const e=r,n=l.__destructure_map.call(null,e),t=l.get.call(null,n,l.keyword("form")),a=l.get.call(null,n,l.keyword("field-config")),o=l.get.call(null,n,l.keyword("input-component")),u=w.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),l.vector(t,l.keyword("key").call(null,a)))),s=u,i=l.__destructure_map.call(null,s),d=l.get.call(null,i,l.keyword("valid")),$=l.get.call(null,i,l.keyword("value")),h=x.call(null),j=function(c,F){const I=F.target.value;return h.call(null,l.vector(l.keyword("rpub.lib.forms/change-input"),l.vector(t,c,I)))};return l.vector(o,l.array_map(l.keyword("type"),l.keyword("type").call(null,a),l.keyword("valid"),(()=>{const c=d;return l.truth_.call(null,c)?c:l.not.call(null,l.contains_QMARK_.call(null,u,l.keyword("value")))})(),l.keyword("name"),l.keyword("key").call(null,a),l.keyword("value"),$,l.keyword("on-change"),function(c){return j.call(null,l.keyword("key").call(null,a),c)}))},A=function(r){const e=r,n=l.__destructure_map.call(null,e),t=n,a=l.get.call(null,n,l.keyword("form")),o=l.get.call(null,n,l.keyword("field-config")),u=w.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),l.vector(a,l.keyword("key").call(null,o),l.keyword("message"))));return l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.str.call(null,l.keyword("key").call(null,o)),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm text-gray-900",l.keyword("for"),"label"),l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"font-semibold"),l.keyword("label").call(null,o)),l.truth_.call(null,u)?l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"text-red-500")," - ",u):null),l.vector(g,t))};export{p as change_input,G as dag_config,A as field,_ as field_values,b as init,g as input,m as ready_to_submit,f as submit_error,v as submit_start,k as submitting,y as validate};
