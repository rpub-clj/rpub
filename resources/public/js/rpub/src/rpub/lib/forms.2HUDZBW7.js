import*as l from"cherry-cljs/cljs.core.js";import{subscribe as y,dispatch as G}from"rpub.lib.substrate";var d=function(r,n,a){const e=l.get.call(null,l.keyword("schema").call(null,r),n);if(l.truth_.call(null,e)){const t=e,c=l.__destructure_map.call(null,t),o=l.get.call(null,c,l.keyword("valid")),u=l.get.call(null,c,l.keyword("message"));return l.truth_.call(null,o.call(null,a))?l.array_map(l.keyword("valid"),!0):l.array_map(l.keyword("valid"),!1,l.keyword("message"),u)}},k=function(r,n){const a=n,e=l.nth.call(null,a,0,null),t=l.nth.call(null,a,1,null),c=l.nth.call(null,a,2,null);return l.update_in.call(null,l.update_in.call(null,l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,e),t,l.keyword("value")),c),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,e),t),l.dissoc,l.keyword("valid"),l.keyword("message")),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,e),t),l.merge,d.call(null,e,t,c))},p=function(r,n){return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,n)),!1)},m=function(r,n){return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,n)),!0)},f=function(r,n){const a=l.reduce_kv.call(null,function(e,t,c){return l.assoc.call(null,e,t,l.merge.call(null,l.array_map(l.keyword("value"),c),d.call(null,n,t,c)))},l.array_map(),l.keyword("initial-values").call(null,n));return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,n)),a)},w=function(r,n){const a=l.truth_.call(null,l.vector_QMARK_.call(null,n))?n:l.vector(n),e=l.seq.call(null,a),t=l.first.call(null,e),c=l.next.call(null,e),o=t,u=c,s=l.get.call(null,l.keyword("rpub.lib.forms/inputs").call(null,r),l.keyword("id").call(null,o));return l.truth_.call(null,l.seq.call(null,u))?l.get_in.call(null,s,u):s},v=function(r,n){const a=l.vals.call(null,l.get_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,n)))),e=l.seq.call(null,a);return l.truth_.call(null,e)?l.every_QMARK_.call(null,l.keyword("valid"),a):e},b=function(r,n){return l.get.call(null,l.keyword("rpub.lib.forms/submitting").call(null,r),l.keyword("id").call(null,n))},K=function(r,n){const a=n,e=l.seq.call(null,a),t=l.first.call(null,e),c=l.next.call(null,e),o=t,u=c,s=o,i=l.truth_.call(null,l.keyword_QMARK_.call(null,s))?l.subs.call(null,l.str.call(null,s),1):null;switch(i){case"rpub.lib.forms/field-values":return l.apply.call(null,w,r,u);case"rpub.lib.forms/ready-to-submit":return l.apply.call(null,v,r,u);case"rpub.lib.forms/submitting":return l.apply.call(null,b,r,u);default:throw new Error(l.str.call(null,"No matching clause: ",i))}},M=function(r,n){const a=n,e=l.seq.call(null,a),t=l.first.call(null,e),c=l.next.call(null,e),o=t,u=c,s=o,i=l.truth_.call(null,l.keyword_QMARK_.call(null,s))?l.subs.call(null,l.str.call(null,s),1):null;switch(i){case"rpub.lib.forms/init":return l.apply.call(null,f,r,u);case"rpub.lib.forms/change-input":return l.apply.call(null,k,r,u);case"rpub.lib.forms/submit-start":return l.apply.call(null,m,r,u);case"rpub.lib.forms/submit-error":return l.apply.call(null,p,r,u);default:throw new Error(l.str.call(null,"No matching clause: ",i))}},g=function(r){const n=r,a=l.__destructure_map.call(null,n),e=l.get.call(null,a,l.keyword("form")),t=l.get.call(null,a,l.keyword("field-config")),c=l.get.call(null,a,l.keyword("input-component")),o=y.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),l.vector(e,l.keyword("key").call(null,t)))),u=o,s=l.__destructure_map.call(null,u),i=l.get.call(null,s,l.keyword("valid")),h=l.get.call(null,s,l.keyword("value")),q=function(_,x){const A=x.target.value;return G.call(null,l.vector(l.keyword("rpub.lib.forms/change-input"),l.vector(e,_,A)))};return l.vector(c,l.array_map(l.keyword("type"),l.keyword("type").call(null,t),l.keyword("valid"),(()=>{const _=i;return l.truth_.call(null,_)?_:l.not.call(null,l.contains_QMARK_.call(null,o,l.keyword("value")))})(),l.keyword("name"),l.keyword("key").call(null,t),l.keyword("value"),h,l.keyword("on-change"),function(_){return q.call(null,l.keyword("key").call(null,t),_)}))},Q=function(r){const n=r,a=l.__destructure_map.call(null,n),e=a,t=l.get.call(null,a,l.keyword("form")),c=l.get.call(null,a,l.keyword("field-config")),o=y.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),l.vector(t,l.keyword("key").call(null,c),l.keyword("message"))));return l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.str.call(null,l.keyword("key").call(null,c)),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm text-gray-900",l.keyword("for"),"label"),l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"font-semibold"),l.keyword("label").call(null,c)),l.truth_.call(null,o)?l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"text-red-500")," - ",o):null),l.vector(g,e))};export{k as change_input,Q as field,w as field_values,f as init,g as input,K as query,v as ready_to_submit,p as submit_error,m as submit_start,b as submitting,M as transact,d as validate};
