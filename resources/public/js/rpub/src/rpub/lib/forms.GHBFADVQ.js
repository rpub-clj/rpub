import*as l from"cherry-cljs/cljs.core.js";import{subscribe as m,dispatch as p}from"rpub.lib.substrate";var k=function(e,u,n){const o=l.get.call(null,l.keyword("schema").call(null,e),u);if(l.truth_.call(null,o)){const r=o,t=l.__destructure_map.call(null,r),c=l.get.call(null,t,l.keyword("valid")),a=l.get.call(null,t,l.keyword("message"));return l.truth_.call(null,c.call(null,n))?l.array_map(l.keyword("valid"),!0):l.array_map(l.keyword("valid"),!1,l.keyword("message"),a)}},f=function(e,u){return l.reduce_kv.call(null,function(n,o,r){return l.assoc.call(null,n,o,l.merge.call(null,l.array_map(l.keyword("value"),r),k.call(null,e,o,r)))},l.array_map(),u)},w=function(e,u){const n=u,o=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null),t=l.nth.call(null,n,2,null),c=l.nth.call(null,n,3,null);return l.update_in.call(null,l.update_in.call(null,l.assoc_in.call(null,e,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r),t,l.keyword("value")),c),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r),t),l.dissoc,l.keyword("valid"),l.keyword("message")),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r),t),l.merge,k.call(null,r,t,c))},v=function(e,u){const n=u,o=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null),t=l.nth.call(null,n,2,null);return l.assoc_in.call(null,e,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r),t,l.keyword("touched")),!0)},b=function(e,u){const n=u,o=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null);return l.assoc_in.call(null,e,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,r)),!1)},g=function(e,u){const n=u,o=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null);return l.update_in.call(null,l.assoc_in.call(null,e,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,r)),!0),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r)),l.update_vals,function(t){return l.assoc.call(null,t,l.keyword("touched"),!0)})},h=function(e,u){const n=u,o=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null),t=f.call(null,r,l.keyword("initial-values").call(null,r));return l.assoc_in.call(null,e,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r)),t)},q=function(e,u){const n=u,o=l.seq.call(null,n),r=l.first.call(null,o),t=l.next.call(null,o),c=r,a=l.first.call(null,t),s=l.next.call(null,t),y=a,i=s,d=l.get.call(null,l.keyword("rpub.lib.forms/inputs").call(null,e),l.keyword("id").call(null,y));return l.truth_.call(null,l.seq.call(null,i))?l.get_in.call(null,d,i):d},x=function(e,u){const n=u,o=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null);return l.get.call(null,l.keyword("rpub.lib.forms/submitting").call(null,e),l.keyword("id").call(null,r))},A=function(e,u){const n=u,o=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null),t=l.nth.call(null,n,2,null),c=l.update_vals.call(null,l.get_in.call(null,e,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r))),function(a){return l.assoc.call(null,a,l.keyword("touched"),!0)});return l.truth_.call(null,(()=>{const a=l.seq.call(null,c);return l.truth_.call(null,a)?l.every_QMARK_.call(null,l.keyword("valid"),l.vals.call(null,c)):a})())&&t.call(null),l.assoc_in.call(null,e,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r)),c)},G=l.array_map(l.keyword("queries"),l.array_map(l.keyword("rpub.lib.forms/field-values"),q,l.keyword("rpub.lib.forms/submitting"),x),l.keyword("transactions"),l.array_map(l.keyword("rpub.lib.forms/init"),h,l.keyword("rpub.lib.forms/change-input"),w,l.keyword("rpub.lib.forms/blur-input"),v,l.keyword("rpub.lib.forms/submit-form"),A,l.keyword("rpub.lib.forms/submit-start"),g,l.keyword("rpub.lib.forms/submit-error"),b)),K=function(e){const u=e,n=l.__destructure_map.call(null,u),o=l.get.call(null,n,l.keyword("form")),r=l.get.call(null,n,l.keyword("field-config")),t=l.get.call(null,n,l.keyword("input-component")),c=m.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),o,l.keyword("key").call(null,r))),a=c,s=l.__destructure_map.call(null,a),y=l.get.call(null,s,l.keyword("valid")),i=l.get.call(null,s,l.keyword("touched")),d=l.get.call(null,s,l.keyword("value")),M=function(_,Q){const R=Q.target.value;return p.call(null,l.vector(l.keyword("rpub.lib.forms/change-input"),o,_,R))};return l.vector(t,l.array_map(l.keyword("type"),l.keyword("type").call(null,r),l.keyword("valid"),(()=>{const _=y;return l.truth_.call(null,_)?_:l.not.call(null,l.contains_QMARK_.call(null,c,l.keyword("value")))})(),l.keyword("touched"),i,l.keyword("name"),l.keyword("key").call(null,r),l.keyword("value"),d,l.keyword("on-blur"),function(_){return p.call(null,l.vector(l.keyword("rpub.lib.forms/blur-input"),o,l.keyword("key").call(null,r)))},l.keyword("on-change"),function(_){return M.call(null,l.keyword("key").call(null,r),_)}))},j=function(e){const u=e,n=l.__destructure_map.call(null,u),o=n,r=l.get.call(null,n,l.keyword("form")),t=l.get.call(null,n,l.keyword("field-config")),a=m.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),r,l.keyword("key").call(null,t))),s=l.__destructure_map.call(null,a),y=l.get.call(null,s,l.keyword("touched")),i=l.get.call(null,s,l.keyword("message"));return l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.str.call(null,l.keyword("key").call(null,t)),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm text-gray-900",l.keyword("for"),"label"),l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"font-semibold"),l.keyword("label").call(null,t)),l.truth_.call(null,(()=>{const d=y;return l.truth_.call(null,d)?i:d})())?l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"text-red-500")," - ",i):null),l.vector(K,o))};export{v as blur_input,w as change_input,j as field,q as field_values,h as init,K as input,G as model,b as submit_error,A as submit_form,g as submit_start,x as submitting,f as validate_all_inputs,k as validate_single_input};
