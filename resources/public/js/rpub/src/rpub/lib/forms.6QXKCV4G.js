import*as l from"cherry-cljs/cljs.core.js";import"rpub.lib.dag";import{use_dag as G}from"rpub.lib.dag.react";var w=function(r,e,a){const o=l.get.call(null,l.keyword("schema").call(null,r),e);if(l.truth_.call(null,o)){const n=o,t=l.__destructure_map.call(null,n),c=l.get.call(null,t,l.keyword("valid")),s=l.get.call(null,t,l.keyword("message"));return l.truth_.call(null,c.call(null,a))?l.array_map(l.keyword("valid"),!0):l.array_map(l.keyword("valid"),!1,l.keyword("message"),s)}},v=function(r,e){const a=e,o=l.nth.call(null,a,0,null),n=l.nth.call(null,a,1,null),t=l.nth.call(null,a,2,null);return l.update_in.call(null,l.update_in.call(null,l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,o),n,l.keyword("value")),t),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,o),n),l.dissoc,l.keyword("valid"),l.keyword("message")),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,o),n),l.merge,w.call(null,o,n,t))},b=function(r,e){return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,e)),!1)},p=function(r,e){return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,e)),!0)},f=function(r,e){return l.assoc_in.call(null,r,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,e)),l.update_vals.call(null,l.keyword("schema").call(null,e),l.constantly.call(null,l.array_map())))},d=(()=>{const r=function(e){switch(l.alength.call(null,arguments)){case 1:return r.cljs$core$IFn$_invoke$arity$1(arguments[0]);case 2:return r.cljs$core$IFn$_invoke$arity$2(arguments[0],arguments[1]);default:throw new Error(l.str.call(null,"Invalid arity: ",l.alength.call(null,arguments)))}};return r.cljs$core$IFn$_invoke$arity$1=function(e){return l.keyword("rpub.lib.forms/inputs").call(null,e)},r.cljs$core$IFn$_invoke$arity$2=function(e,a){const o=a,n=l.nth.call(null,o,0,null),t=l.nth.call(null,o,1,null);return l.select_keys.call(null,l.get.call(null,d.call(null,e),l.keyword("id").call(null,n)),t)},r.cljs$lang$maxFixedArity=2,r})(),y=(()=>{const r=function(e){switch(l.alength.call(null,arguments)){case 1:return r.cljs$core$IFn$_invoke$arity$1(arguments[0]);case 2:return r.cljs$core$IFn$_invoke$arity$2(arguments[0],arguments[1]);default:throw new Error(l.str.call(null,"Invalid arity: ",l.alength.call(null,arguments)))}};return r.cljs$core$IFn$_invoke$arity$1=function(e){return l.keyword("rpub.lib.forms/field-values").call(null,l.keyword("rpub.lib.dag/values").call(null,e))},r.cljs$core$IFn$_invoke$arity$2=function(e,a){return l.every_QMARK_.call(null,l.keyword("valid"),l.vals.call(null,l.get.call(null,y.call(null,e),l.keyword("id").call(null,a))))},r.cljs$lang$maxFixedArity=2,r})(),k=(()=>{const r=function(e){switch(l.alength.call(null,arguments)){case 1:return r.cljs$core$IFn$_invoke$arity$1(arguments[0]);case 2:return r.cljs$core$IFn$_invoke$arity$2(arguments[0],arguments[1]);default:throw new Error(l.str.call(null,"Invalid arity: ",l.alength.call(null,arguments)))}};return r.cljs$core$IFn$_invoke$arity$1=function(e){return l.keyword("rpub.lib.forms/submitting").call(null,e)},r.cljs$core$IFn$_invoke$arity$2=function(e,a){return l.get.call(null,k.call(null,e),l.keyword("id").call(null,a))},r.cljs$lang$maxFixedArity=2,r})(),A=l.array_map(l.keyword("nodes"),l.array_map(l.keyword("rpub.lib.forms/init"),l.array_map(l.keyword("push"),f),l.keyword("rpub.lib.forms/change-input"),l.array_map(l.keyword("push"),v),l.keyword("rpub.lib.forms/field-values"),l.array_map(l.keyword("calc"),d),l.keyword("rpub.lib.forms/submit-error"),l.array_map(l.keyword("push"),b),l.keyword("rpub.lib.forms/submit-start"),l.array_map(l.keyword("push"),p),l.keyword("rpub.lib.forms/submitting"),l.array_map(l.keyword("calc"),k),l.keyword("rpub.lib.forms/ready-to-submit"),l.array_map(l.keyword("calc"),y)),l.keyword("edges"),l.vector(l.vector(l.keyword("rpub.lib.forms/init"),l.keyword("rpub.lib.forms/field-values")),l.vector(l.keyword("rpub.lib.forms/change-input"),l.keyword("rpub.lib.forms/field-values")),l.vector(l.keyword("rpub.lib.forms/field-values"),l.keyword("rpub.lib.forms/ready-to-submit")),l.vector(l.keyword("rpub.lib.forms/submit-error"),l.keyword("rpub.lib.forms/submitting")),l.vector(l.keyword("rpub.lib.forms/submit-start"),l.keyword("rpub.lib.forms/submitting")))),E=function(r){const e=r,a=l.__destructure_map.call(null,e),o=l.get.call(null,a,l.keyword("form")),n=l.get.call(null,a,l.keyword("field-config")),t=l.get.call(null,a,l.keyword("input-component")),c=G.call(null,l.vector(l.vector(l.keyword("rpub.lib.forms/field-values"),l.vector(o,l.vector(l.keyword("key").call(null,n)))))),s=l.nth.call(null,c,0,null),g=l.nth.call(null,c,1,null),i=l.get_in.call(null,s,l.vector(l.vector(l.keyword("rpub.lib.forms/field-values"),l.vector(o,l.vector(l.keyword("key").call(null,n)))),l.keyword("key").call(null,n))),$=i,m=l.__destructure_map.call(null,$),_=l.get.call(null,m,l.keyword("message")),h=l.get.call(null,m,l.keyword("valid")),j=l.get.call(null,i,l.keyword("value"),l.keyword("value").call(null,n)),F=function(u,I){const x=I.target.value;return g.call(null,l.keyword("rpub.lib.forms/change-input"),l.vector(o,u,x))};return l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.str.call(null,l.keyword("key").call(null,n)),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm text-gray-900",l.keyword("for"),"label"),l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"font-semibold"),l.keyword("label").call(null,n)),l.truth_.call(null,_)?l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"text-red-500")," - ",_):null),l.vector(t,l.array_map(l.keyword("type"),l.keyword("type").call(null,n),l.keyword("valid"),(()=>{const u=h;return l.truth_.call(null,u)?u:l.not.call(null,l.contains_QMARK_.call(null,i,l.keyword("value")))})(),l.keyword("name"),l.keyword("key").call(null,n),l.keyword("value"),j,l.keyword("on-change"),function(u){return F.call(null,l.keyword("key").call(null,n),u)})))};export{v as change_input,A as dag_config,E as field,d as field_values,f as init,y as ready_to_submit,b as submit_error,p as submit_start,k as submitting,w as validate};
