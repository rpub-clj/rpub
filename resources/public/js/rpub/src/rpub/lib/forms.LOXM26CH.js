import*as l from"cherry-cljs/cljs.core.js";import{subscribe as k,dispatch as K}from"rpub.lib.substrate";var m=function(o,t,n){const a=l.get.call(null,l.keyword("schema").call(null,o),t);if(l.truth_.call(null,a)){const r=a,e=l.__destructure_map.call(null,r),c=l.get.call(null,e,l.keyword("valid")),u=l.get.call(null,e,l.keyword("message"));return l.truth_.call(null,c.call(null,n))?l.array_map(l.keyword("valid"),!0):l.array_map(l.keyword("valid"),!1,l.keyword("message"),u)}},f=function(o,t){const n=t,a=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null),e=l.nth.call(null,n,2,null),c=l.nth.call(null,n,3,null);return l.update_in.call(null,l.update_in.call(null,l.assoc_in.call(null,o,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r),e,l.keyword("value")),c),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r),e),l.dissoc,l.keyword("valid"),l.keyword("message")),l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r),e),l.merge,m.call(null,r,e,c))},p=function(o,t){const n=t,a=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null);return l.assoc_in.call(null,o,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,r)),!1)},w=function(o,t){const n=t,a=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null);return l.assoc_in.call(null,o,l.vector(l.keyword("rpub.lib.forms/submitting"),l.keyword("id").call(null,r)),!0)},v=function(o,t){const n=t,a=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null),e=l.reduce_kv.call(null,function(c,u,s){return l.assoc.call(null,c,u,l.merge.call(null,l.array_map(l.keyword("value"),s),m.call(null,r,u,s)))},l.array_map(),l.keyword("initial-values").call(null,r));return l.assoc_in.call(null,o,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r)),e)},b=function(o,t){const n=t,a=l.seq.call(null,n),r=l.first.call(null,a),e=l.next.call(null,a),c=r,u=l.first.call(null,e),s=l.next.call(null,e),y=u,_=s,d=l.get.call(null,l.keyword("rpub.lib.forms/inputs").call(null,o),l.keyword("id").call(null,y));return l.truth_.call(null,l.seq.call(null,_))?l.get_in.call(null,d,_):d},g=function(o,t){const n=t,a=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null),e=l.vals.call(null,l.get_in.call(null,o,l.vector(l.keyword("rpub.lib.forms/inputs"),l.keyword("id").call(null,r)))),c=l.seq.call(null,e);return l.truth_.call(null,c)?l.every_QMARK_.call(null,l.keyword("valid"),e):c},h=function(o,t){const n=t,a=l.nth.call(null,n,0,null),r=l.nth.call(null,n,1,null);return l.get.call(null,l.keyword("rpub.lib.forms/submitting").call(null,o),l.keyword("id").call(null,r))},M=l.array_map(l.keyword("queries"),l.array_map(l.keyword("rpub.lib.forms/field-values"),b,l.keyword("rpub.lib.forms/ready-to-submit"),g,l.keyword("rpub.lib.forms/submitting"),h),l.keyword("transactions"),l.array_map(l.keyword("rpub.lib.forms/init"),v,l.keyword("rpub.lib.forms/change-input"),f,l.keyword("rpub.lib.forms/submit-start"),w,l.keyword("rpub.lib.forms/submit-error"),p)),q=function(o){const t=o,n=l.__destructure_map.call(null,t),a=l.get.call(null,n,l.keyword("form")),r=l.get.call(null,n,l.keyword("field-config")),e=l.get.call(null,n,l.keyword("input-component")),c=k.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),a,l.keyword("key").call(null,r))),u=c,s=l.__destructure_map.call(null,u),y=l.get.call(null,s,l.keyword("valid")),_=l.get.call(null,s,l.keyword("value")),d=function(i,x){const A=x.target.value;return K.call(null,l.vector(l.keyword("rpub.lib.forms/change-input"),a,i,A))};return l.vector(e,l.array_map(l.keyword("type"),l.keyword("type").call(null,r),l.keyword("valid"),(()=>{const i=y;return l.truth_.call(null,i)?i:l.not.call(null,l.contains_QMARK_.call(null,c,l.keyword("value")))})(),l.keyword("name"),l.keyword("key").call(null,r),l.keyword("value"),_,l.keyword("on-change"),function(i){return d.call(null,l.keyword("key").call(null,r),i)}))},Q=function(o){const t=o,n=l.__destructure_map.call(null,t),a=n,r=l.get.call(null,n,l.keyword("form")),e=l.get.call(null,n,l.keyword("field-config")),c=k.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),r,l.keyword("key").call(null,e),l.keyword("message")));return l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.str.call(null,l.keyword("key").call(null,e)),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm text-gray-900",l.keyword("for"),"label"),l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"font-semibold"),l.keyword("label").call(null,e)),l.truth_.call(null,c)?l.vector(l.keyword("span"),l.array_map(l.keyword("class"),"text-red-500")," - ",c):null),l.vector(q,a))};export{f as change_input,Q as field,b as field_values,v as init,q as input,M as model,g as ready_to_submit,p as submit_error,w as submit_start,h as submitting,m as validate};
