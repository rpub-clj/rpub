import*as e from"cherry-cljs/cljs.core.js";import*as O from"cherry-cljs/lib/clojure.string.js";import*as A from"rads.inflections";import*as g from"rpub.lib.html";import*as R from"rpub.lib.http";import*as C from"rpub.lib.permalinks";import{subscribe as h,dispatch as q}from"rpub.lib.substrate";import*as x from"rpub.plugins.admin.helpers";var G=function(t){const r=t,l=e.__destructure_map.call(null,r),n=e.get.call(null,l,e.keyword("content-item")),a=e.get.call(null,l,e.keyword("editing")),s=e.get.call(null,l,e.keyword("creating")),y=e.get.call(null,l,e.keyword("field-types")),c=n,m=e.__destructure_map.call(null,c),u=e.get.call(null,m,e.keyword("content-type"));return e.vector(e.keyword("div"),function v(S){return new e.LazySeq(null,function(){let f=S;for(;;){const b=e.seq.call(null,f);if(e.truth_.call(null,b)){const i=b;if(e.truth_.call(null,e.chunked_seq_QMARK_.call(null,i))){const o=e.chunk_first.call(null,i),k=e.count.call(null,o),w=e.chunk_buffer.call(null,k);return(()=>{let _=0;for(;;){if(_<k){const d=e._nth.call(null,o,_),I=e.get_in.call(null,n,e.vector(e.keyword("document"),e.keyword("id").call(null,d)));e.chunk_append.call(null,w,e.vector(e.keyword("div.max-w-xl.mb-4"),e.array_map(e.keyword("key"),e.keyword("id").call(null,d)),e.vector(e.keyword("label.font-semibold.mb-1.block"),e.array_map(e.keyword("for"),e.keyword("name").call(null,d)),e.keyword("name").call(null,d)),e.vector(e.keyword("div"),g.custom_element.call(null,e.vector(e.get_in.call(null,y,e.vector(e.keyword("type").call(null,d),e.keyword("input"))),e.array_map(e.keyword("field"),d,e.keyword("value"),I,e.keyword("on-change"),function(K){const M=K.target.value;return q.call(null,e.vector(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-change"),e.assoc.call(null,d,e.keyword("value"),M)))},e.keyword("editing"),a,e.keyword("creating"),s)))))),_=e.unchecked_inc.call(null,_);continue}else return!0;break}})()?e.chunk_cons.call(null,e.chunk.call(null,w),v.call(null,e.chunk_rest.call(null,i))):e.chunk_cons.call(null,e.chunk.call(null,w),null)}else{const o=e.first.call(null,i),k=e.get_in.call(null,n,e.vector(e.keyword("document"),e.keyword("id").call(null,o)));return e.cons.call(null,e.vector(e.keyword("div.max-w-xl.mb-4"),e.array_map(e.keyword("key"),e.keyword("id").call(null,o)),e.vector(e.keyword("label.font-semibold.mb-1.block"),e.array_map(e.keyword("for"),e.keyword("name").call(null,o)),e.keyword("name").call(null,o)),e.vector(e.keyword("div"),g.custom_element.call(null,e.vector(e.get_in.call(null,y,e.vector(e.keyword("type").call(null,o),e.keyword("input"))),e.array_map(e.keyword("field"),o,e.keyword("value"),k,e.keyword("on-change"),function(w){const _=w.target.value;return q.call(null,e.vector(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-change"),e.assoc.call(null,o,e.keyword("value"),_)))},e.keyword("editing"),a,e.keyword("creating"),s))))),v.call(null,e.rest.call(null,i)))}}break}},null,null)}.call(null,e.sort_by.call(null,e.keyword("rank"),e.keyword("fields").call(null,u))))},z=function(t,r,l){t.preventDefault(),q.call(null,e.vector(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/start-submit")));const n=e.update.call(null,l,e.keyword("document"),e.merge,r);return R.post.call(null,"/admin/api/content-types/update-content-item",e.array_map(e.keyword("body"),n))},D=function(t){const r=t,l=e.__destructure_map.call(null,r),n=e.get.call(null,l,e.keyword("content-type")),a=e.get.call(null,l,e.keyword("field-types")),s=h.call(null,e.vector(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/submitting"))),y=h.call(null,e.vector(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-values"))),c=e.array_map(e.keyword("content-type"),n,e.keyword("document"),e.into.call(null,e.array_map(),e.map.call(null,function(u){return e.vector(e.keyword("id").call(null,u),null)},e.keyword("fields").call(null,n)))),m=function(u){return z.call(null,u,y,c).then(function(p){return window.location=e.str.call(null,"/admin/content-types/",e.name.call(null,e.keyword("slug").call(null,n)),"/content-items/",e.keyword("id").call(null,p))})};return e.vector(e.keyword("div.p-4"),e.vector(x.box,e.array_map(e.keyword("class"),"mb-4",e.keyword("title"),e.str.call(null,"New ",A.singular.call(null,e.get_in.call(null,c,e.vector(e.keyword("content-type"),e.keyword("name"))))))),e.vector(e.keyword("form"),e.array_map(e.keyword("on-submit"),m),e.vector(x.box,e.array_map(e.keyword("content"),e.vector(e.keyword("div"),e.vector(G,e.array_map(e.keyword("content-item"),c,e.keyword("field-types"),a,e.keyword("creating"),!0)),e.vector(g.submit_button,e.array_map(e.keyword("ready-label"),"Create",e.keyword("submit-label"),"Creating...",e.keyword("submitting"),s)))))))},E=function(t){const r=t,l=e.__destructure_map.call(null,r),n=e.get.call(null,l,e.keyword("content-type")),a=e.get.call(null,l,e.keyword("content-item")),s=e.get.call(null,l,e.keyword("field-types")),y=e.get.call(null,l,e.keyword("site-base-url")),c=e.get.call(null,l,e.keyword("permalink-routes")),m=h.call(null,e.vector(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/submitting"))),u=h.call(null,e.vector(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-values"))),p=A.singular.call(null,e.keyword("name").call(null,n)),v=e.get_in.call(null,a,e.vector(e.keyword("fields"),"Title")),S=C.router.call(null,c),f=e.str.call(null,y,e.keyword("path").call(null,C.match_by_name.call(null,S,e.keyword("single"),e.array_map(e.keyword("content-type-slug"),e.name.call(null,e.keyword("slug").call(null,n)),e.keyword("content-item-slug"),e.get_in.call(null,a,e.vector(e.keyword("fields"),"Slug")))))),b=function(o){return confirm(e.str.call(null,"Are you sure you want to delete this ",O.lower_case.call(null,p),"?"))},i=function(o){return z.call(null,o,u,a).then(function(k){return window.location.reload()})};return e.vector(e.keyword("div.p-4"),e.vector(x.box,e.array_map(e.keyword("class"),"mb-4",e.keyword("title"),e.vector(e.keyword("div.flex"),e.vector(e.keyword("div.grow"),e.vector(e.keyword("span.italic.text-blue-600"),e.str.call(null,p,": ")),v),e.vector(e.keyword("div"),e.vector(g.delete_button,e.array_map(e.keyword("on-click"),b),"Delete"))),e.keyword("content"),e.vector(e.keyword("div"),e.vector(e.keyword("a.underline.text-gray-500"),e.array_map(e.keyword("href"),f,e.keyword("target"),"_blank"),f)))),e.vector(e.keyword("form"),e.array_map(e.keyword("on-submit"),i),e.vector(x.box,e.array_map(e.keyword("content"),e.vector(e.keyword("div"),e.vector(G,e.array_map(e.keyword("content-item"),a,e.keyword("field-types"),s,e.keyword("editing"),!0)),e.vector(g.submit_button,e.array_map(e.keyword("ready-label"),"Save",e.keyword("submit-label"),"Saving...",e.keyword("submitting"),m)))))))},L=function(t){const r=t,l=e.__destructure_map.call(null,r),n=l,a=e.get.call(null,l,e.keyword("editing"));return e.truth_.call(null,a)?e.vector(E,n):e.vector(D,n)},N=function(t,r){return e.assoc_in.call(null,t,e.vector(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-values"),e.keyword("id").call(null,r)),e.keyword("value").call(null,r))},Q=function(t){return e.assoc.call(null,t,e.keyword("rpub.plugins.content-types.admin.single-content-item-page/submitting"),!0)},T=e.array_map(e.keyword("queries"),e.array_map(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-values"),function(t,r){return e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-values").call(null,t)},e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-change"),N,e.keyword("rpub.plugins.content-types.admin.single-content-item-page/start-submit"),Q,e.keyword("rpub.plugins.content-types.admin.single-content-item-page/submitting"),function(t,r){return e.keyword("rpub.plugins.content-types.admin.single-content-item-page/submitting").call(null,t)}),e.keyword("transactions"),e.array_map(e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-change"),e.keyword("rpub.plugins.content-types.admin.single-content-item-page/field-values"),e.keyword("rpub.plugins.content-types.admin.single-content-item-page/start-submit"),e.keyword("rpub.plugins.content-types.admin.single-content-item-page/submitting"))),U=e.array_map(e.keyword("page-id"),e.keyword("single-content-item-page"),e.keyword("component"),L,e.keyword("model"),T);export{U as config,G as content_item_fields,E as edit_content_item_page,N as field_change,T as model,D as new_content_item_page,L as single_content_item_page,Q as start_submit,z as submit_form};
