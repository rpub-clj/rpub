import*as l from"cherry-cljs/cljs.core.js";import{useState as x,useRef as b}from"react";var Q=function(_,d){const n=_,o=l.__destructure_map.call(null,n),s=o,u=l.get.call(null,o,l.keyword("items")),c=l.get.call(null,o,l.keyword("item-refs")),e=d.clientY,t=l.vec.call(null,l.map_indexed.call(null,function(r,i){const y=l.get.call(null,c.current,r).getBoundingClientRect();return l.array_map(l.keyword("index"),r,l.keyword("top"),y.top,l.keyword("bottom"),y.bottom,l.keyword("middle"),y.top+y.height/2)},u)),a=e<l.keyword("top").call(null,l.first.call(null,t)),g=e>l.keyword("bottom").call(null,l.nth.call(null,t,l.count.call(null,t)-1));if(a)return 0;if(g)return l.count.call(null,t);if(l.truth_.call(null,l.keyword("else"))){let r=0;for(;;){if(r>=l.count.call(null,t))return null;{const i=l.get.call(null,t,r),p=l.get.call(null,t,r+1),y=(()=>{const w=p;if(l.truth_.call(null,w)){const h=e<l.keyword("top").call(null,p);return h&&e>l.keyword("bottom").call(null,i)}else return w})(),v=(()=>{const w=e>=l.keyword("top").call(null,i);return w&&e<=l.keyword("bottom").call(null,i)})(),k=e<l.keyword("middle").call(null,i);if(l.truth_.call(null,y))return r+1;if(l.truth_.call(null,v))return k?r:r+1;if(l.truth_.call(null,l.keyword("else"))){r=r+1;continue}else return null}break}}else return null},R=function(_){const d=_,n=l.__destructure_map.call(null,d),o=n,s=l.get.call(null,n,l.keyword("items")),u=l.get.call(null,n,l.keyword("drag-source")),c=l.get.call(null,n,l.keyword("drag-index")),e=l.get.call(null,n,l.keyword("drop-index"));if(l.truth_.call(null,u)){const t=l.into_array.call(null,s);return t.splice(e,0,u),t}else if(l.truth_.call(null,(()=>{const t=e;return l.truth_.call(null,t)?c!==e:t})())){const t=l.into_array.call(null,s),a=t.splice(c,1),g=l.nth.call(null,a,0,null),r=e>c?e-1:e;return t.splice(r,0,g),t}},A=function(_){const d=_,n=l.__destructure_map.call(null,d),o=l.get.call(null,n,l.keyword("index")),s=l.get.call(null,n,l.keyword("item")),u=l.get.call(null,n,l.keyword("drag-state")),c=l.get.call(null,n,l.keyword("item-component")),e=l.get.call(null,n,l.keyword("on-drag-end")),t=l.get.call(null,n,l.keyword("on-drag-start")),a=u,g=l.__destructure_map.call(null,a),r=l.get.call(null,g,l.keyword("item-refs"));return l.vector(c,l.array_map(l.keyword("item-data"),s,l.keyword("item-props"),l.array_map(l.keyword("ref"),function(i){const p=l.assoc.call(null,r.current,o,i);return r.current=p},l.keyword("draggable"),!0,l.keyword("on-drag-start"),function(){return t.call(null,o)},l.keyword("on-drag-end"),e)))},E=function(_,d){const n=_,o=l.__destructure_map.call(null,n),s=o,u=l.get.call(null,o,l.keyword("drag-source")),c=l.get.call(null,o,l.keyword("drag-index")),e=l.get.call(null,o,l.keyword("drop-index")),t=(()=>{const a=l.some_QMARK_.call(null,c);return l.truth_.call(null,a)?a:u})();return l.truth_.call(null,t)?l._EQ_.call(null,e,d):t},K=function(_){const d=_,n=l.__destructure_map.call(null,d),o=n,s=l.get.call(null,n,l.keyword("drag-source")),u=l.get.call(null,n,l.keyword("drag-index")),c=l.get.call(null,n,l.keyword("drop-index")),e=l.get.call(null,n,l.keyword("items")),t=(()=>{const a=l.some_QMARK_.call(null,u);return l.truth_.call(null,a)?a:s})();return l.truth_.call(null,t)?l._EQ_.call(null,c,l.count.call(null,e)):t},S=function(_){const d=_,n=l.__destructure_map.call(null,d),o=l.get.call(null,n,l.keyword("drag-source")),s=l.get.call(null,n,l.keyword("items")),u=l.get.call(null,n,l.keyword("item-component")),c=l.get.call(null,n,l.keyword("divider-component")),e=l.get.call(null,n,l.keyword("on-items-change")),t=x.call(null,null),a=l.nth.call(null,t,0,null),g=l.nth.call(null,t,1,null),r=x.call(null,null),i=l.nth.call(null,r,0,null),p=l.nth.call(null,r,1,null),y=b.call(null,null),v=b.call(null,l.vector()),k=l.array_map(l.keyword("items"),s,l.keyword("item-refs"),v,l.keyword("drag-index"),a,l.keyword("drag-source"),o,l.keyword("drop-index"),i),w=function(m){return g.call(null,m)},h=function(m){m.preventDefault();const f=Q.call(null,k,m);if(i!==f)return p.call(null,f)},M=function(m){m.preventDefault();const f=R.call(null,k);if(l.truth_.call(null,f)){const D=f;e.call(null,l.seq.call(null,D))}return g.call(null,null),p.call(null,null)},G=function(){return g.call(null,null),p.call(null,null)};return l.vector(l.keyword("div"),l.array_map(l.keyword("ref"),y,l.keyword("on-drag-over"),h,l.keyword("on-drop"),M),l.map_indexed.call(null,function(m,f){return l.vector(l.keyword("div"),l.array_map(l.keyword("key"),m),l.truth_.call(null,E.call(null,k,m))?l.vector(c):null,l.vector(A,l.array_map(l.keyword("index"),m,l.keyword("item"),f,l.keyword("item-component"),u,l.keyword("drag-state"),k,l.keyword("on-drag-end"),G,l.keyword("on-drag-start"),w)))},s),l.truth_.call(null,K.call(null,k))?l.vector(c):null)};export{Q as apply_drag_over,R as apply_drop,K as bottom_divider_QMARK_,A as draggable_item,S as draggable_list,E as top_divider_QMARK_};
