import*as l from"cherry-cljs/cljs.core.js";import{use_dag as M}from"rpub.lib.dag.react";import*as b from"rpub.lib.html";import*as N from"rpub.lib.http";import*as v from"rpub.plugins.admin.impl";var G=function(r){const y=r,s=l.__destructure_map.call(null,y),f=s,_=l.get.call(null,s,l.keyword("settings")),h=M.call(null,l.vector(l.keyword("rpub.plugins.admin.settings-page/field-values"),l.keyword("rpub.plugins.admin.settings-page/submitting"))),A=l.nth.call(null,h,0,null),x=l.__destructure_map.call(null,A),k=l.get.call(null,x,l.keyword("rpub.plugins.admin.settings-page/field-values")),D=l.get.call(null,x,l.keyword("rpub.plugins.admin.settings-page/submitting")),g=l.nth.call(null,h,1,null),S=v.index_by.call(null,l.keyword("key"),_),I=l.array_map(l.keyword("format"),l.keyword("transit")),q=function(i,o){const c=o.target.value;return g.call(null,l.keyword("rpub.plugins.admin.settings-page/change-input"),l.vector(i,c))},K=function(i){i.preventDefault(),g.call(null,l.keyword("rpub.plugins.admin.settings-page/submit-start"));const o=function(t,n){return l.truth_.call(null,n)?g.call(null,l.keyword("rpub.plugins.admin.settings-page/submit-error")):window.location.reload()},c=l.vals.call(null,l.update_vals.call(null,l.merge_with.call(null,function(t,n){return l.assoc.call(null,t,l.keyword("value"),n)},S,k),function(t){return l.select_keys.call(null,t,l.vector(l.keyword("key"),l.keyword("value")))})),m=l.merge.call(null,I,l.array_map(l.keyword("body"),l.array_map(l.keyword("settings"),c),l.keyword("on-complete"),o));return N.post.call(null,"/admin/api/update-settings",m)};return l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"p-4"),l.vector(v.box,l.array_map(l.keyword("title"),"Settings",l.keyword("content"),l.vector(l.keyword("section"),l.array_map(l.keyword("class"),"bg-white"),l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"max-w-2xl"),l.vector(l.keyword("form"),l.array_map(l.keyword("on-submit"),K),l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"grid gap-4 sm:grid-cols-2 sm:gap-6"),function o(c){return new l.LazySeq(null,function(){let m=c;for(;;){const t=l.seq.call(null,m);if(l.truth_.call(null,t)){const n=t;if(l.truth_.call(null,l.chunked_seq_QMARK_.call(null,n))){const e=l.chunk_first.call(null,n),a=l.count.call(null,e),w=l.chunk_buffer.call(null,a);return(()=>{let d=0;for(;;){if(d<a){const u=l._nth.call(null,e,d);l.chunk_append.call(null,w,l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.keyword("key").call(null,u),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm font-semibold text-gray-900",l.keyword("for"),"name"),l.keyword("label").call(null,u)),l.prn.call(null,u),l.vector(b.input2,l.array_map(l.keyword("type"),l.keyword("text"),l.keyword("name"),l.keyword("key").call(null,u),l.keyword("value"),(()=>{const p=l.get.call(null,k,l.keyword("key").call(null,u));return l.truth_.call(null,p)?p:l.keyword("value").call(null,u)})(),l.keyword("on-change"),function(p){return q.call(null,l.keyword("key").call(null,u),p)})))),d=l.unchecked_inc.call(null,d);continue}else return!0;break}})()?l.chunk_cons.call(null,l.chunk.call(null,w),o.call(null,l.chunk_rest.call(null,n))):l.chunk_cons.call(null,l.chunk.call(null,w),null)}else{const e=l.first.call(null,n);return l.cons.call(null,l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.keyword("key").call(null,e),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm font-semibold text-gray-900",l.keyword("for"),"name"),l.keyword("label").call(null,e)),l.prn.call(null,e),l.vector(b.input2,l.array_map(l.keyword("type"),l.keyword("text"),l.keyword("name"),l.keyword("key").call(null,e),l.keyword("value"),(()=>{const a=l.get.call(null,k,l.keyword("key").call(null,e));return l.truth_.call(null,a)?a:l.keyword("value").call(null,e)})(),l.keyword("on-change"),function(a){return q.call(null,l.keyword("key").call(null,e),a)}))),o.call(null,l.rest.call(null,n)))}}break}},null,null)}.call(null,l.sort_by.call(null,l.keyword("label"),l.vals.call(null,S))),l.vector(b.submit_button,l.array_map(l.keyword("ready-label"),"Save",l.keyword("submit-label"),"Saving...",l.keyword("submitting"),D)))))))))},z=function(r,y){const s=y,f=l.nth.call(null,s,0,null),_=l.nth.call(null,s,1,null);return l.assoc_in.call(null,r,l.vector(l.keyword("inputs"),f,l.keyword("value")),_)},E=function(r){return l.assoc.call(null,r,l.keyword("rpub.plugins.admin.settings-page/submitting"),!0)},L=function(r){return l.assoc.call(null,r,l.keyword("rpub.plugins.admin.settings-page/submitting"),!1)},Q=l.array_map(l.keyword("nodes"),l.array_map(l.keyword("rpub.plugins.admin.settings-page/change-input"),l.array_map(l.keyword("push"),z),l.keyword("rpub.plugins.admin.settings-page/field-values"),l.array_map(l.keyword("calc"),v.field_values),l.keyword("rpub.plugins.admin.settings-page/submit-error"),l.array_map(l.keyword("push"),L),l.keyword("rpub.plugins.admin.settings-page/submit-start"),l.array_map(l.keyword("push"),E),l.keyword("rpub.plugins.admin.settings-page/submitting"),l.array_map(l.keyword("calc"),l.keyword("rpub.plugins.admin.settings-page/submitting"))),l.keyword("edges"),l.vector(l.vector(l.keyword("rpub.plugins.admin.settings-page/change-input"),l.keyword("rpub.plugins.admin.settings-page/field-values")),l.vector(l.keyword("rpub.plugins.admin.settings-page/submit-error"),l.keyword("rpub.plugins.admin.settings-page/submitting")),l.vector(l.keyword("rpub.plugins.admin.settings-page/submit-start"),l.keyword("rpub.plugins.admin.settings-page/submitting")))),O=l.array_map(l.keyword("page-id"),l.keyword("settings-page"),l.keyword("component"),G,l.keyword("dag-config"),Q);export{z as change_input,O as config,Q as dag_config,G as page,L as submit_error,E as submit_start};
