import*as l from"cherry-cljs/cljs.core.js";import"rpub.lib.forms";import*as i from"rpub.lib.html";import*as A from"rpub.lib.http";import{subscribe as f,dispatch as b}from"rpub.lib.substrate";import*as g from"rpub.plugins.admin.helpers";var h=function(x){const S=x,w=l.__destructure_map.call(null,S),K=w,q=l.get.call(null,w,l.keyword("settings")),c=l.array_map(l.keyword("id"),l.keyword("rpub.plugins.admin.settings.page/form")),y=f.call(null,l.vector(l.keyword("rpub.lib.forms/field-values"),c)),z=f.call(null,l.vector(l.keyword("rpub.lib.forms/submitting"),c)),m=g.index_by.call(null,l.keyword("key"),q),p=function(u,a){const r=a.target.value;return b.call(null,l.vector(l.keyword("rpub.lib.forms/change-input"),c,u,r))},G=function(u){u.preventDefault();const a=l.vals.call(null,l.update_vals.call(null,l.merge_with.call(null,function(r,d){return l.assoc.call(null,r,l.keyword("value"),l.keyword("value").call(null,d))},m,y),function(r){return l.select_keys.call(null,r,l.vector(l.keyword("key"),l.keyword("value")))}));return A.post.call(null,"/admin/api/update-settings",l.array_map(l.keyword("body"),l.array_map(l.keyword("settings"),a))).then(function(){return window.location.reload()}).catch(function(r){return b.call(null,l.vector(l.keyword("rpub.lib.forms/submit-error"),c))})};return l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"p-4"),l.vector(g.box,l.array_map(l.keyword("title"),"Settings",l.keyword("content"),l.vector(l.keyword("section"),l.array_map(l.keyword("class"),"bg-white"),l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"max-w-2xl"),l.vector(l.keyword("form"),l.array_map(l.keyword("on-submit"),G),l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"grid gap-4 sm:grid-cols-2 sm:gap-6"),function a(r){return new l.LazySeq(null,function(){let d=r;for(;;){const v=l.seq.call(null,d);if(l.truth_.call(null,v)){const o=v;if(l.truth_.call(null,l.chunked_seq_QMARK_.call(null,o))){const e=l.chunk_first.call(null,o),n=l.count.call(null,e),k=l.chunk_buffer.call(null,n);return(()=>{let s=0;for(;;){if(s<n){const t=l._nth.call(null,e,s);l.chunk_append.call(null,k,l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.keyword("key").call(null,t),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm font-semibold text-gray-900",l.keyword("for"),"name"),l.keyword("label").call(null,t)),l.prn.call(null,t),l.vector(i.input2,l.array_map(l.keyword("type"),l.keyword("text"),l.keyword("name"),l.keyword("key").call(null,t),l.keyword("value"),(()=>{const _=l.get_in.call(null,y,l.vector(l.keyword("key").call(null,t),l.keyword("value")));return l.truth_.call(null,_)?_:l.keyword("value").call(null,t)})(),l.keyword("on-change"),function(_){return p.call(null,l.keyword("key").call(null,t),_)})))),s=l.unchecked_inc.call(null,s);continue}else return!0;break}})()?l.chunk_cons.call(null,l.chunk.call(null,k),a.call(null,l.chunk_rest.call(null,o))):l.chunk_cons.call(null,l.chunk.call(null,k),null)}else{const e=l.first.call(null,o);return l.cons.call(null,l.vector(l.keyword("div"),l.array_map(l.keyword("key"),l.keyword("key").call(null,e),l.keyword("class"),"sm:col-span-2"),l.vector(l.keyword("label"),l.array_map(l.keyword("class"),"block mb-2 text-sm font-semibold text-gray-900",l.keyword("for"),"name"),l.keyword("label").call(null,e)),l.prn.call(null,e),l.vector(i.input2,l.array_map(l.keyword("type"),l.keyword("text"),l.keyword("name"),l.keyword("key").call(null,e),l.keyword("value"),(()=>{const n=l.get_in.call(null,y,l.vector(l.keyword("key").call(null,e),l.keyword("value")));return l.truth_.call(null,n)?n:l.keyword("value").call(null,e)})(),l.keyword("on-change"),function(n){return p.call(null,l.keyword("key").call(null,e),n)}))),a.call(null,l.rest.call(null,o)))}}break}},null,null)}.call(null,l.sort_by.call(null,l.keyword("label"),l.vals.call(null,m))),l.vector(i.submit_button,l.array_map(l.keyword("ready-label"),"Save",l.keyword("submit-label"),"Saving...",l.keyword("submitting"),z)))))))))},D=l.array_map(l.keyword("page-id"),l.keyword("settings-page"),l.keyword("component"),h);export{D as config,h as page};
