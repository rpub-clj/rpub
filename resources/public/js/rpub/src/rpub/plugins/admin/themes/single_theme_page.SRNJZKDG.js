import*as e from"cherry-cljs/cljs.core.js";import{use_dag as v}from"rpub.lib.dag.react";import*as y from"rpub.lib.html";import*as w from"rpub.lib.http";import*as b from"rpub.plugins.admin.helpers";var f=function(r){const a=r,t=e.__destructure_map.call(null,a),l=e.get.call(null,t,e.keyword("value")),o=e.get.call(null,t,e.keyword("on-change"));return e.vector(e.keyword("textarea"),e.array_map(e.keyword("class"),"w-full min-h-96 font-app-mono bg-gray-50 text-sm",e.keyword("value"),l,e.keyword("on-change"),o))},_=function(r){const a=r,t=e.__destructure_map.call(null,a),l=e.get.call(null,t,e.keyword("field-config")),o=e.get.call(null,t,e.keyword("input-component")),c=v.call(null,e.vector(e.keyword("rpub.plugins.admin.themes.single-theme-page/field-values"))),i=e.nth.call(null,c,0,null),m=e.__destructure_map.call(null,i),d=e.get.call(null,m,e.keyword("rpub.plugins.admin.themes.single-theme-page/field-values")),p=e.nth.call(null,c,1,null),g=e.get.call(null,d,e.keyword("key").call(null,l),e.keyword("value").call(null,l)),k=function(u,s){const n=s.target.value;return p.call(null,e.keyword("rpub.plugins.admin.themes.single-theme-page/change-input"),e.vector(u,n))};return e.vector(e.keyword("div"),e.array_map(e.keyword("key"),e.str.call(null,e.keyword("key").call(null,l)),e.keyword("class"),"sm:col-span-2"),e.vector(e.keyword("label"),e.array_map(e.keyword("class"),"block mb-2 text-sm font-semibold text-gray-900",e.keyword("for"),"label"),e.keyword("label").call(null,l)),e.vector(o,e.array_map(e.keyword("type"),e.keyword("type").call(null,l),e.keyword("name"),e.keyword("key").call(null,l),e.keyword("value"),g,e.keyword("on-change"),function(u){return k.call(null,e.keyword("key").call(null,l),u)})))},$=function(r){const a=r,t=e.__destructure_map.call(null,a),l=e.get.call(null,t,e.keyword("theme")),o=v.call(null,e.vector(e.keyword("rpub.plugins.admin.themes.single-theme-page/submitting"),e.keyword("rpub.plugins.admin.themes.single-theme-page/field-values"))),c=e.nth.call(null,o,0,null),i=e.__destructure_map.call(null,c),m=e.get.call(null,i,e.keyword("rpub.plugins.admin.themes.single-theme-page/submitting")),d=e.get.call(null,i,e.keyword("rpub.plugins.admin.themes.single-theme-page/field-values")),p=function(u){u.preventDefault();const s=e.array_map(e.keyword("theme"),e.dissoc.call(null,e.assoc.call(null,e.merge.call(null,l,d),e.keyword("value"),e.array_map(e.keyword("html-template"),(()=>{const n=e.keyword("html-template").call(null,d);return e.truth_.call(null,n)?n:e.get_in.call(null,l,e.vector(e.keyword("value"),e.keyword("html-template")))})())),e.keyword("html-template")));return e.truth_.call(null,e.keyword("new").call(null,l))?w.post.call(null,"/admin/api/create-theme",e.array_map(e.keyword("body"),s)).then(function(n){return window.location="/admin/themes"}):w.post.call(null,"/admin/api/update-theme",e.array_map(e.keyword("body"),s)).then(function(n){return window.location.reload()})},g=function(u){const s=e.str.call(null,'Are you sure want to delete the "',e.keyword("label").call(null,l),'" theme?');if(e.truth_.call(null,confirm(s))){const n=e.select_keys.call(null,l,e.vector(e.keyword("id")));return w.post.call(null,"/admin/api/delete-theme",e.array_map(e.keyword("body"),n)).then(function(A){return window.location="/admin/themes"})}},k=e.get_in.call(null,l,e.vector(e.keyword("value"),e.keyword("html-template")));return e.vector(e.keyword("div"),e.array_map(e.keyword("class"),"p-4"),e.vector(b.box,e.array_map(e.keyword("class"),"mb-4",e.keyword("title"),e.vector(e.keyword("div.flex"),e.vector(e.keyword("div.grow"),e.truth_.call(null,e.keyword("new").call(null,l))?"New Theme":e.vector(e.keyword("div"),e.vector(e.keyword("span.italic.text-blue-600"),"Theme: "),e.keyword("label").call(null,l))),e.vector(e.keyword("div"),e.truth_.call(null,e.keyword("new").call(null,l))?null:e.vector(y.delete_button,e.array_map(e.keyword("on-click"),g),"Delete"))))),e.vector(b.box,e.array_map(e.keyword("content"),e.vector(e.keyword("form"),e.array_map(e.keyword("on-submit"),p),e.vector(e.keyword("div"),e.array_map(e.keyword("class"),"grid gap-4 sm:grid-cols-2 sm:gap-6"),e.vector(e.keyword("div"),e.array_map(e.keyword("class"),"max-w-2xl"),e.vector(_,e.array_map(e.keyword("field-config"),e.array_map(e.keyword("key"),e.keyword("label"),e.keyword("label"),"Name",e.keyword("type"),e.keyword("text"),e.keyword("value"),e.keyword("label").call(null,l)),e.keyword("input-component"),y.input2))),e.vector(_,e.array_map(e.keyword("field-config"),e.array_map(e.keyword("key"),e.keyword("html-template"),e.keyword("label"),"HTML",e.keyword("value"),k),e.keyword("input-component"),f)),e.truth_.call(null,e.keyword("new").call(null,l))?e.vector(y.submit_button,e.array_map(e.keyword("ready-label"),"Create",e.keyword("submit-label"),"Creating...",e.keyword("submitting"),m)):e.vector(y.submit_button,e.array_map(e.keyword("ready-label"),"Save",e.keyword("submit-label"),"Saving...",e.keyword("submitting"),m)))))))},x=function(r,a){const t=a,l=e.nth.call(null,t,0,null),o=e.nth.call(null,t,1,null);return e.assoc_in.call(null,r,e.vector(e.keyword("rpub.plugins.admin.themes.single-theme-page/inputs"),l,e.keyword("value")),o)},j=function(r){return e.assoc.call(null,r,e.keyword("rpub.plugins.admin.themes.single-theme-page/submitting"),!1)},F=function(r){return e.assoc.call(null,r,e.keyword("rpub.plugins.admin.themes.single-theme-page/submitting"),!0)},h=(()=>{const r=function(a){switch(e.alength.call(null,arguments)){case 1:return r.cljs$core$IFn$_invoke$arity$1(arguments[0]);case 2:return r.cljs$core$IFn$_invoke$arity$2(arguments[0],arguments[1]);default:throw new Error(e.str.call(null,"Invalid arity: ",e.alength.call(null,arguments)))}};return r.cljs$core$IFn$_invoke$arity$1=function(a){return h.call(null,a,e.keys.call(null,e.keyword("rpub.plugins.admin.themes.single-theme-page/inputs").call(null,a)))},r.cljs$core$IFn$_invoke$arity$2=function(a,t){return e.update_vals.call(null,e.select_keys.call(null,e.keyword("rpub.plugins.admin.themes.single-theme-page/inputs").call(null,a),t),e.keyword("value"))},r.cljs$lang$maxFixedArity=2,r})(),I=e.array_map(e.keyword("nodes"),e.array_map(e.keyword("rpub.plugins.admin.themes.single-theme-page/change-input"),e.array_map(e.keyword("push"),x),e.keyword("rpub.plugins.admin.themes.single-theme-page/field-values"),e.array_map(e.keyword("calc"),h),e.keyword("rpub.plugins.admin.themes.single-theme-page/submit-error"),e.array_map(e.keyword("push"),j),e.keyword("rpub.plugins.admin.themes.single-theme-page/submit-start"),e.array_map(e.keyword("push"),F),e.keyword("rpub.plugins.admin.themes.single-theme-page/submitting"),e.array_map(e.keyword("calc"),e.keyword("rpub.plugins.admin.themes.single-theme-page/submitting"))),e.keyword("edges"),e.vector(e.vector(e.keyword("rpub.plugins.admin.themes.single-theme-page/change-input"),e.keyword("rpub.plugins.admin.themes.single-theme-page/field-values")),e.vector(e.keyword("rpub.plugins.admin.themes.single-theme-page/submit-error"),e.keyword("rpub.plugins.admin.themes.single-theme-page/submitting")),e.vector(e.keyword("rpub.plugins.admin.themes.single-theme-page/submit-start"),e.keyword("rpub.plugins.admin.themes.single-theme-page/submitting")))),T=e.array_map(e.keyword("page-id"),e.keyword("single-theme-page"),e.keyword("component"),$,e.keyword("dag-config"),I);export{x as change_input,T as config,I as dag_config,_ as field,h as field_values,f as html_input,$ as page,j as submit_error,F as submit_start};
