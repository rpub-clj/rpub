import*as l from"cherry-cljs/cljs.core.js";import{useEffect as Q}from"react";import*as f from"rpub.lib.forms";import*as g from"rpub.lib.html";import*as z from"rpub.lib.http";import{subscribe as h,dispatch as m}from"rpub.lib.substrate";import*as G from"rpub.plugins.admin.helpers";var b=l.array_map(l.keyword("username"),l.array_map(l.keyword("valid"),function(e){const r=l.string_QMARK_.call(null,e);if(l.truth_.call(null,r)){const n=l.seq.call(null,e);return l.truth_.call(null,n)?l.count.call(null,e)>=3:n}else return r},l.keyword("message"),"Must be at least 3 characters"),l.keyword("password"),l.array_map(l.keyword("valid"),function(e){const r=l.string_QMARK_.call(null,e);if(l.truth_.call(null,r)){const n=l.seq.call(null,e);return l.truth_.call(null,n)?l.count.call(null,e)>=6:n}else return r},l.keyword("message"),"Must be at least 6 characters"),l.keyword("roles"),l.array_map(l.keyword("valid"),function(e){const r=l.string_QMARK_.call(null,e);return l.truth_.call(null,r)?l.seq.call(null,e):r},l.keyword("message"),"Required")),p=function(e){const r=e,n=l.__destructure_map.call(null,r),a=l.get.call(null,n,l.keyword("value")),o=l.get.call(null,n,l.keyword("valid")),i=l.get.call(null,n,l.keyword("on-change")),d=l.get.call(null,n,l.keyword("type")),u=l.get.call(null,n,l.keyword("name"));return l.vector(g.input2,l.array_map(l.keyword("type"),d,l.keyword("name"),u,l.keyword("value"),a,l.keyword("class"),l.truth_.call(null,l.false_QMARK_.call(null,o))?"border-red-500":"",l.keyword("on-change"),i))},v=function(e){const r=l.array_map(l.keyword("id"),l.keyword("rpub.plugins.admin.users.single-user-page/form"),l.keyword("schema"),b),n=h.call(null,l.vector(l.keyword("rpub.lib.forms/submitting"),r)),a=h.call(null,l.vector(l.keyword("rpub.lib.forms/ready-to-submit"),r)),o=Q.call(null,function(){return m.call(null,l.vector(l.keyword("rpub.lib.forms/init"),r))},[]),i=function(u){if(u.preventDefault(),l.truth_.call(null,a))return m.call(null,l.keyword("rpub.plugins.admin.users.single-user-page/submit-start")),z.post.call(null,"/admin/api/create-user",l.array_map(l.keyword("body"),l.array_map())).then(function(c){return window.location.reload()}).catch(function(c){return m.call(null,l.keyword("rpub.plugins.admin.users.single-user-page/submit-error"))})},d=l.vector(l.array_map(l.keyword("key"),l.keyword("username"),l.keyword("label"),"Username",l.keyword("type"),l.keyword("text")),l.array_map(l.keyword("key"),l.keyword("password"),l.keyword("label"),"Password",l.keyword("type"),l.keyword("password")));return l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"p-4"),l.vector(G.box,l.array_map(l.keyword("title"),"New User",l.keyword("content"),l.vector(l.keyword("section"),l.array_map(l.keyword("class"),"bg-white"),l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"max-w-2xl"),l.vector(l.keyword("form"),l.array_map(l.keyword("on-submit"),i),l.vector(l.keyword("div"),l.array_map(l.keyword("class"),"grid gap-4 sm:grid-cols-2 sm:gap-6"),function c(x){return new l.LazySeq(null,function(){let A=x;for(;;){const k=l.seq.call(null,A);if(l.truth_.call(null,k)){const t=k;if(l.truth_.call(null,l.chunked_seq_QMARK_.call(null,t))){const s=l.chunk_first.call(null,t),w=l.count.call(null,s),y=l.chunk_buffer.call(null,w);return(()=>{let _=0;for(;;){if(_<w){const K=l._nth.call(null,s,_);l.chunk_append.call(null,y,l.vector(f.field,l.array_map(l.keyword("form"),r,l.keyword("field-config"),K,l.keyword("input-component"),p))),_=l.unchecked_inc.call(null,_);continue}else return!0;break}})()?l.chunk_cons.call(null,l.chunk.call(null,y),c.call(null,l.chunk_rest.call(null,t))):l.chunk_cons.call(null,l.chunk.call(null,y),null)}else{const s=l.first.call(null,t);return l.cons.call(null,l.vector(f.field,l.array_map(l.keyword("form"),r,l.keyword("field-config"),s,l.keyword("input-component"),p)),c.call(null,l.rest.call(null,t)))}}break}},null,null)}.call(null,d),l.vector(g.submit_button,l.array_map(l.keyword("ready-label"),"Create",l.keyword("submit-label"),"Creating...",l.keyword("submitting"),n,l.keyword("disabled"),l.not.call(null,a))))))))))},q=function(e){return null},M=function(e){const r=e,n=l.__destructure_map.call(null,r),a=n,o=l.get.call(null,n,l.keyword("editing"));return l.truth_.call(null,o)?l.vector(q,a):l.vector(v,a)},U=l.array_map(l.keyword("page-id"),l.keyword("single-user-page"),l.keyword("component"),M);export{U as config,q as edit_user_page,b as form_schema,p as html_input,v as new_user_page,M as single_user_page};
